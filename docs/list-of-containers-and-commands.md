<!-- id: 36372911 -->

This page is a list of docker images and commands for the container service. Some of them are finished, and others are in some stage of design or progress.

Contributions to this page are very welcome. These can be in the form of links to published images / commands, proposals for future work, or comments. Edit the page directly on the wiki, or make a pull request to the [markdown source document](https://github.com/NrgXnat/container-service/blob/master/docs/list-of-containers-and-commands.md) in the container service repo.

# Completed

| Title                   | Author         | Docker Hub                                                               | GitHub                                                                                                          | Notes                                                                                                                                                                                                                                    |
|:------------------------|:---------------|:-------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DICOM to NIFTI          | Flavin         | [xnat/dcm2niix](https://hub.docker.com/r/xnat/dcm2niix)                  | [nrgxnat/docker-images/dcm2niix](https://github.com/NrgXnat/docker-images/tree/master/dcm2niix)                 |                                                                                                                                                                                                                                          |
| DICOM to BIDS           | Flavin         | [xnat/dcm2bids-session](https://hub.docker.com/r/xnat/dcm2bids-session/) | [nrgxnat/docker-images/dcm2bids-session](https://github.com/NrgXnat/docker-images/tree/master/dcm2bids-session) |                                                                                                                                                                                                                                          |
| Debug                   | Flavin         | [xnat/debug-command](https://hub.docker.com/r/xnat/debug-command/)       | [nrgxnat/docker-images/debug-command](https github.com/NrgXnat/docker-images/tree/master/debug-command)         | Test that your container service is working by executing something, anything at all. Look through the [command JSON](https://github.com/NrgXnat/docker-images/blob/master/debug-command/command.json) to understand the basic structure. |
| XNAT Populate           | Charlie Moore  | [greppy/xnat-populate](https://hub.docker.com/r/greppy/xnat-populate/)   | [nrgxnat/xnat-populate](https://github.com/NrgXnat/docker-images/tree/master/xnat-populate)                     | Meant for dev use only.                                                                                                                                                                                                                  |
| CONDR_METS lesion atlas | Misha / Flavin |                                                                          |                                                                                                                 | Not published. 1. see [note on NIL Tools](#a-note-on-nil-tools). 2. This was built as a demo that relies on access to a non-public CNDA project.                                                                                         |


# Proposed

## On deck
| Title              | Container                                                                                                         | Notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Status                                                                                                                                                                         | Ticket                                          |
|:-------------------|:------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------|
| Snapshot generator | ImageJ?                                                                                                           | Don't want to just containerize WebBasedQcImageCreator. Want to re-write snapshot generation, possibly with ImageJ script.                                                                                                                                                                                                                                                                                                                                                                                                                   | <ac:structured-macro ac:name="status"><ac:parameter ac:name="colour">Blue</ac:parameter><ac:parameter ac:name="title">Open</ac:parameter></ac:structured-macro>                | [CS-193](https://issues.xnat.org/browse/CS-193) |
| Defacer            | Either an official one with the MATLAB runtime, or roll our own                                                   | Use Misha's [mask_face](http://nrg.wustl.edu/software/face-masking/usage/); also see [face masking pipeline on Marketplace](http://marketplace.xnat.org/plugin/face-masking/). This tool uses MATLAB, which is a problem; Misha is investigating making a compiled version.                                                                                                                                                                                                                                                                  | <ac:structured-macro ac:name="status"><ac:parameter ac:name="colour">Blue</ac:parameter><ac:parameter ac:name="title">Open</ac:parameter></ac:structured-macro>                | [CS-195](https://issues.xnat.org/browse/CS-195) |
| ImageJ             | [fiji/fiji](https://hub.docker.com/r/fiji/fiji/) or build from [Dockerfiles](https://github.com/fiji/dockerfiles) | ImageJ is less a single tool and more of a scripting platform. As such, users would want to be able to run their own scripts for this container to be useful. Or we would need to write a ton of commands covering lots of basic functions (which I do not know, and which would never cover everything).                                                                                                                                                                                                                                    | <ac:structured-macro ac:name="status"><ac:parameter ac:name="colour">Grey</ac:parameter><ac:parameter ac:name="title">Needs expert review</ac:parameter></ac:structured-macro> | [CS-196](https://issues.xnat.org/browse/CS-196) |
| Freesurfer         | Roll our own or use someone else's (plenty of freesurfer images out there)                                        | Would be better by resolving [CS-29](https://issues.xnat.org/browse/CS-29) (XNAT has no internal API to add objects from XML files) and [CS-80](https://issues.xnat.org/browse/CS-80) (no way to upload output files to other previously-created outputs).                                                                                                                                                                                                                                                                                   | <ac:structured-macro ac:name="status"><ac:parameter ac:name="colour">Yellow</ac:parameter><ac:parameter ac:name="title">In progress</ac:parameter></ac:structured-macro>       | [CS-199](https://issues.xnat.org/browse/CS-199) |
| BIDS Apps          | [Numerous](http://bids-apps.neuroimaging.io/apps/)                                                                | We can only run these on BIDS-formatted data, which we don't have (much of). And they are made to be run either on a single subject or across a group of them with the change of a single flag, but we can't launch in the latter way ([bulk launching N inputs into one container](https://wiki.xnat.org/display/CS/Bulk+Launching+Containers)).                                                                                                                                                                                            | <ac:structured-macro ac:name="status"><ac:parameter ac:name="colour">Blue</ac:parameter><ac:parameter ac:name="title">Open</ac:parameter></ac:structured-macro>                | [CS-237](https://issues.xnat.org/browse/CS-237) |
| 3DSlicer           | Unknown                                                                                                           | Slicer has an [execution model](https://www.slicer.org/wiki/Documentation/Nightly/Developers/SlicerExecutionModel) ([also see examples](https://github.com/Slicer/Slicer/tree/master/Modules/CLI)), instances of which may be automatically convertible into commands (_sans_ wrapper). [Discussions about this are ongoing between John Flavin and Andrey Fedorov](https://docs.google.com/document/d/1XRLWm_gJj8YC7TagihQd8DQfqT1XSTm1SMOCzfxEfqM/edit?usp=sharing). Not sure how to containerize Slicer extensions, which users may want. | <ac:structured-macro ac:name="status"><ac:parameter ac:name="colour">Blue</ac:parameter><ac:parameter ac:name="title">Open</ac:parameter></ac:structured-macro>                | [CS-198](https://issues.xnat.org/browse/CS-198) |

## Future
| Title      | Blocked by                                                               | Would be better if...                                                                                                                                                                                                                | Ticket                                          |
|:-----------|:-------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------|
| Anonymizer |                                                                          | ...container service could delete / quarantine existing unanonymized (nonymized?) data; ...container service could provide project and/or site-wide anon scripts [CS-48](https://issues.xnat.org/browse/CS-48)                       | [CS-194](https://issues.xnat.org/browse/CS-194) |
| PUP        | Containerization of / public repo for [NIL Tools](#a-note-on-nil-tools). | ...XNAT had an internal API to add objects from XML files [CS-29](https://issues.xnat.org/browse/CS-29); ...container service could upload outputs to other previously-created outputs [CS-80](https://issues.xnat.org/browse/CS-80) | [CS-200](https://issues.xnat.org/browse/CS-200) |

# A Note on NIL Tools
Many of the existing tools employed in the NRG lab—often as pipelines on CNDA or TIP—rely on tools written by the NeuroImaging Lab (NIL). These tools are not easily containerizable for two reasons:

1. The source code is not publicly available. This impedes publishing derivative works in several ways.
    * Dockerfiles should not reference this code. The purpose of a Dockerfile is to facilitate reproducible builds of Docker images on different machines or by different people. If the NIL tools are included, then the build may only take place on those few machines that have access to the source code.
    * The code should not be contained within a Docker image not controlled by NIL. This image would become the _de facto_ official release of the tools. If such an image were to exist, it should by all rights belong to the owner and creator of those tools: the NIL.
2. The tools often rely on the local availablity of atlas image files. Those altas images are available on the internal servers we have here, but are not generally available. If the atlases were included in a Docker image, its size would be many tens of gigabytes (typical sizes are tens to hundreds of megabytes). This would be prohibitive to install or develop against.

For this reason, any tool that is written using the NIL tools is not, in general, possible to containerize at this time. Exceptions are certainly possible; for instance, the lesion atlas image used only a few NIL tools, which could be copied directly into the Docker image itself. However, while this image can be created, is not distributable for reason 1. above.