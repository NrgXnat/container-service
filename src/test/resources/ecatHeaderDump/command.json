{
    "name": "ecat-dump scan",
    "description": "Runs ECAT dump tools on an XNAT scan's ECAT resource",
    "docker-image": "ecat-dump",
    "run": {
        "command-line": "lmhdr /input >> /output/ecat-dump.txt && lshdr /input >> /output/ecat-dump.txt",
        "mounts": [
            {
                "name": "ecat-in",
                "type": "input",
                "path": "/input",
                "file-input": "scan-ecat-file"
            },
            {
                "name": "dump-out",
                "type": "output",
                "path": "/output"
            }
        ]
    },
    "inputs": [
        {
            "name": "scan",
            "description": "Input scan",
            "type": "Scan",
            "required": true,
            "matcher": "'ECAT' in @.resources[*].label"
        },
        {
            "name": "scan-ecats",
            "description": "The scan's ecat resource",
            "type": "Resource",
            "parent": "scan",
            "matcher": "@.label == 'ECAT'"
        },
        {
            "name": "scan-ecat-file",
            "description": "The scan's ecat resource's files",
            "type": "File",
            "parent": "scan-ecats",
            "matcher": "@.name =~ /.*v/"
        }
    ],
    "outputs": [
        {
            "name": "dump-out",
            "description": "The ECAT file dump resource",
            "type": "Resource",
            "parent": "scan",
            "label": "HEADERDUMP",
            "files": {
                "mount": "dump-out",
                "path": "ecat-dump.txt"
            }
        }
    ]
}