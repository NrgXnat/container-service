
####
#### Container Setup Group
####

dockerSetupPanel:
    kind: panel
    name: dockerSetupPanel
    label: Docker Server Setup
    footer: false
    contents:
        containerHostTemplate:
            tag: "div#container-host-editor-template.html-template"
            contents:
                containerHostEditor:
                    kind: panel.form
                    name: containerHostEditor
                    id: container-host-editor
                    header: false
                    footer: false
                    action: /xapi/docker/server
                    contentType: json
                    contents:
                        pad:
                            tag: div.pad20top
                        host:
                            kind: panel.input.text
                            id: host-name
                            name: host
                            label: Host Name
                            validation: not-empty
                        certPath:
                            kind: panel.input.text
                            id: cert-path
                            name: certPath
                            label: "Certificate Path"
                            className: hidden
        containerHostTable:
            tag: "div#container-host-manager"
        containerHostScript:
#            tag: script|src="/scripts/xnat/admin/containerHostManagement.js"
            tag: script|src="~/scripts/xnat/admin/containerHostManagement.js"

imageHostsPanel:
    kind: panel
    name: imageHosts
    label: Image Hosts
    footer: false
    contents:
        imageHostTemplate:
            tag: "div#image-host-editor-template.html-template"
            contents:
                imageHostEditor:
                    kind: panel.form
                    name: imageHostEditor
                    id: image-host-editor
                    header: false
                    footer: false
                    action: /xapi/docker/hubs
                    contentType: json
                    contents:
                        pad:
                            tag: div.pad20
                            contents:
                                id:
                                    kind: panel.input.hidden
                                    id: id
                                    name: hubId
                                name:
                                    kind: panel.input.text
                                    id: hub-name
                                    name: name
                                    label: Image Hub Name
                                    validation: not-empty
                                url:
                                    kind: panel.input.text
                                    id: hub-url
                                    name: url
                                    label: URL
                                    validation: url not-empty
                                divider:
                                    tag: "hr"
                                subhead:
                                    tag: "p"
                                    content: Optional host login settings
                                username:
                                    kind: panel.input.text
                                    id: hub-username
                                    name: username
                                    label: "Username"
                                email:
                                    kind: panel.input.text
                                    id: hub-email
                                    name: email
                                    label: "Email Address"
                                    validation: email
                                password:
                                    kind: panel.input.password
                                    id: hub-password
                                    name: password
                                    label: "Password"
        imageHostTable:
            tag: "div#image-host-manager"
        imageHostScript:
#            tag: script|src="/scripts/xnat/admin/imageHostManagement.js"
           tag: script|src="~/scripts/xnat/admin/imageHostManagement.js"

installedImagesPanel:
    kind: panel
    name: installedImagesPanel
    label: Installed Container Images and Commands
    footer: false
    contents:
        imageFilterBar:
            tag: "div#image-filter-bar"
        imageListContainer:
            tag: "div#image-list-container"
        addImageTemplate:
            tag: "div#add-image-template.html-template"
            contents:
                addImageform:
                    kind: panel
                    name: addImageForm
                    id: add-image-form
                    header: false
                    footer: false
                    contents:
                        pad:
                            tag: div.pad20
                            contents:
                                hubSelector:
                                    kind: panel.select.single
                                    name: hubId
                                    label: Select Image Hub
                                    element:
                                        title: Select Image Hub
                                        disabled: disabled
                                imageName:
                                    kind: panel.input.text
                                    name: image
                                    label: Image Name
                                    validation: not-empty
                                    element:
                                        title: Enter Image Name
                                    description: >
                                        Specify the image name to pull, including the account name (if necessary). For example, to pull the XNAT dcm2niix image, enter "xnat/dcm2niix"
                                tag:
                                    kind: panel.input.text
                                    name: tag
                                    label: Version Tag
                                    value: ":latest"
                                    element:
                                        title: Enter Version Tag (Optional)
                                    description: >
                                        "Specify the tag version of the image to pull. The default is :latest"
                                saveCommands:
                                    kind: panel.input.hidden
                                    name: save-commands
                                    value: true
        setCommandDefaults:
            tag: "div#set-command-defaults-template.html-template"
            contents:
                setCommandDefaultForm:
                    kind: panel
                    name: setCommandDefaultsForm
                    id: set-command-defaults-form
                    header: false
                    footer: false
                    contents:
                        pad:
                            tag: div.pad20
                            contents:
                                imageId:
                                    kind: panel.input.hidden
                                    name: imageId
                                commandId:
                                    kind: panel.input.hidden
                                    name: commandId
        commandViewerTemplate:
            tag: "div#command-viewer-template.html-template"
            contents:
                commandViewer:
                    kind: panel
                    name: commandViewer
                    id: command-viewer
                    header: false
                    footer: false
                    contents:
                        pad:
                            tag: div.pad20
                            contents:
                                commandViewerDisplay:
                                    tag: textarea.commandViewer
        imagePanelScript:
#           tag: script|src="/scripts/xnat/admin/imageListManagement.js"
            tag: script|src="~/scripts/xnat/admin/imageListManagement.js"
        panelStyleSheet:
#            tag: link|rel="stylesheet"|type="text/css"|href="/scripts/xnat/admin/imagePanelStyle.css"
            tag: link|rel="stylesheet"|type="text/css"|href="~/scripts/xnat/admin/imagePanelStyle.css"


#################################################
####  Root Site Admin Spawner Config Object  ####
#################################################

siteSettings:
    kind: tabs
    name: containerAdminPage
    label: Administer Container Service
    meta:
        tabGroups:
            containerServiceTabGroup: Container Service
    contains: tabs
    tabs:
        containerServicesTab:
            kind: tab
            name: containerSetupTab
            label: Container Server Setup
            group: containerServiceTabGroup
            active: true
            contents:
                ${dockerSetupPanel}
                ${imageHostsPanel}
        imageCommandTab:
            kind: tab
            name: imagesCommandsTab
            label: "Images & Commands"
            group: containerServiceTabGroup
            active: false
            contents:
                ${installedImagesPanel}